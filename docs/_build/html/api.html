

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Python API &mdash; PerturbedHalos  documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Welcome to PerturbedHalos’s documentation!" href="index.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> PerturbedHalos
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Python API</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-PerturbedHalos.Cosmology">Cosmology Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-PerturbedHalos.MassFunction">Mass Function Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-PerturbedHalos.HaloPhysics">Halo Physics Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-PerturbedHalos.MassIntegrals">Mass Integrals Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-PerturbedHalos.HaloPower">Halo Power Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-PerturbedHalos.CountsCovariance">Counts Covariance Module</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">PerturbedHalos</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Python API</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/api.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="python-api">
<h1>Python API<a class="headerlink" href="#python-api" title="Permalink to this headline">¶</a></h1>
<div class="section" id="module-PerturbedHalos.Cosmology">
<span id="cosmology-module"></span><h2>Cosmology Module<a class="headerlink" href="#module-PerturbedHalos.Cosmology" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="PerturbedHalos.Cosmology.Cosmology">
<em class="property">class </em><code class="descclassname">PerturbedHalos.Cosmology.</code><code class="descname">Cosmology</code><span class="sig-paren">(</span><em>redshift</em>, <em>name=''</em>, <em>**params</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PerturbedHalos/Cosmology.html#Cosmology"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#PerturbedHalos.Cosmology.Cosmology" title="Permalink to this definition">¶</a></dt>
<dd><p>Class to hold the basic cosmology and CLASS attributes. This can be initialized by a set of cosmological parameters or a pre-defined cosmology.</p>
<p>Loaded cosmological models:</p>
<ul class="simple">
<li><strong>Planck18</strong>: Bestfit cosmology from Planck 2018, using the baseline TT,TE,EE+lowE+lensing likelihood.</li>
<li><strong>Quijote</strong>: Fiducial cosmology from the Quijote simulations of Francisco Villaescusa-Navarro et al.</li>
<li><strong>Abacus</strong>: Fiducial cosmology from the Abacus simulations of Lehman Garrison et al.</li>
</ul>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>redshift</strong> (<em>float</em>) – Desired redshift <span class="math notranslate nohighlight">\(z\)</span></li>
<li><strong>name</strong> (<em>str</em>) – Load cosmology from a list of predetermined cosmologies (see above).</li>
<li><strong>params</strong> (<em>kwargs</em>) – Other parameters from CLASS.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="PerturbedHalos.Cosmology.Cosmology.dlns_dlogM_int">
<code class="descname">dlns_dlogM_int</code><span class="sig-paren">(</span><em>logM</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PerturbedHalos/Cosmology.html#Cosmology.dlns_dlogM_int"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#PerturbedHalos.Cosmology.Cosmology.dlns_dlogM_int" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the value of <span class="math notranslate nohighlight">\(d\ln\sigma/d\log M\)</span> using the prebuilt interpolators, which are constructed if not present.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>logM</strong> (<em>float</em>) – Input <span class="math notranslate nohighlight">\(\log_{10}(M/M_\mathrm{sun})\)</span></td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><span class="math notranslate nohighlight">\(d\ln\sigma/d\log M\)</span></td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">float</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="PerturbedHalos.Cosmology.Cosmology.linear_power">
<code class="descname">linear_power</code><span class="sig-paren">(</span><em>kh_vector</em>, <em>kh_min=0.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PerturbedHalos/Cosmology.html#Cosmology.linear_power"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#PerturbedHalos.Cosmology.Cosmology.linear_power" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the linear power spectrum from CLASS for a vector of input k.</p>
<p>If set, we remove any modes below some minimum k.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>kh_vector</strong> (<em>float</em>) – Vector of wavenumbers (in h/Mpc units) to compute linear power with.</li>
<li><strong>kh_min</strong> (<em>float</em>) – Value of k (in h/Mpc units) below which to set <span class="math notranslate nohighlight">\(P(k) = 0\)</span>, default: 0.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Linear power spectrum in <span class="math notranslate nohighlight">\((h^{-1}\mathrm{Mpc})^3\)</span> units</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">float</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="PerturbedHalos.Cosmology.Cosmology.sigmaM">
<code class="descname">sigmaM</code><span class="sig-paren">(</span><em>M_phys</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PerturbedHalos/Cosmology.html#Cosmology.sigmaM"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#PerturbedHalos.Cosmology.Cosmology.sigmaM" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute <span class="math notranslate nohighlight">\(\sigma(M,z)\)</span> from CLASS as a vector function.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>M_phys</strong> (<em>float</em>) – Physical mass in <span class="math notranslate nohighlight">\(M_\mathrm{sun}\)</span> units.</li>
<li><strong>z</strong> (<em>float</em>) – Redshift.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><span class="math notranslate nohighlight">\(\sigma(M,z)\)</span></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">float</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="PerturbedHalos.Cosmology.Cosmology.sigma_logM_int">
<code class="descname">sigma_logM_int</code><span class="sig-paren">(</span><em>logM</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PerturbedHalos/Cosmology.html#Cosmology.sigma_logM_int"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#PerturbedHalos.Cosmology.Cosmology.sigma_logM_int" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the value of <span class="math notranslate nohighlight">\(\sigma(M,z)\)</span> using the prebuilt interpolators, which are constructed if not present.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>logM</strong> (<em>float</em>) – Input <span class="math notranslate nohighlight">\(\log_{10}(M/M_\mathrm{sun})\)</span></td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><span class="math notranslate nohighlight">\(\sigma(M,z)\)</span></td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">float</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-PerturbedHalos.MassFunction">
<span id="mass-function-module"></span><h2>Mass Function Module<a class="headerlink" href="#module-PerturbedHalos.MassFunction" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="PerturbedHalos.MassFunction.MassFunction">
<em class="property">class </em><code class="descclassname">PerturbedHalos.MassFunction.</code><code class="descname">MassFunction</code><span class="sig-paren">(</span><em>cosmology</em>, <em>mass_function_name='Crocce'</em>, <em>**mass_params</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PerturbedHalos/MassFunction.html#MassFunction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#PerturbedHalos.MassFunction.MassFunction" title="Permalink to this definition">¶</a></dt>
<dd><p>Class to hold a mass function for halos and associated bias.</p>
<p>Implemented Mass Functions:</p>
<ul class="simple">
<li><strong>Sheth-Tormen</strong>: Sheth &amp; Tormen 1999 analytic mass function. This assumes virialized halos, and uses the critical density from Nakamura &amp; Suto 1997.</li>
<li><strong>Tinker</strong>: Tinker et al. 2010, eq. 8. This assume a spherical overdensity, the value of which can be specified.</li>
<li><strong>Crocce</strong>: Crocce et al. 2009, eq. 22. Calibrated from Friends-of-Friends halos with linking length 0.2</li>
<li><strong>Bhattacharya</strong>: Bhattacharya et al. 2010, eq. 12. Calibrated from Friends-of-Friends halos with linking length 0.2</li>
</ul>
<p>Implemented Bias Functions:</p>
<ul class="simple">
<li><strong>Sheth-Tormen</strong> Sheth-Tormen 2001, eq. 8 Associated to the ‘Sheth-Tormen’ mass function.</li>
<li><strong>Tinker</strong>: Tinker et al. 2010, eq. 15. Associated to the ‘Tinker’ mass function.</li>
<li><strong>Crocce</strong>: Peak-background split derivation from the ‘Crocce’ mass function of eq. 22, Crocce et al. 2009.</li>
<li><strong>Bhattacharya</strong>: Bhattacharya et al. 2010, eq. 18. Associated to the ‘Bhattacharya’ mass function.</li>
</ul>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>cosmology</strong> (<a class="reference internal" href="#PerturbedHalos.Cosmology.Cosmology" title="PerturbedHalos.Cosmology.Cosmology"><em>Cosmology</em></a>) – Class instance containing relevant cosmological information</li>
<li><strong>mass_function_name</strong> (<em>str</em>) – Mass function to use (see above), default: ‘Crocce’</li>
<li><strong>mass_param</strong> (<em>kwargs</em>) – Any additional parameters to pass to the class. These include:
- tinker_overdensity: (Only for the Tinker mass function): spherical overdensity defining halos, default: 200</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="PerturbedHalos.MassFunction.MassFunction.linear_halo_bias">
<code class="descname">linear_halo_bias</code><span class="sig-paren">(</span><em>m_h</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PerturbedHalos/MassFunction.html#MassFunction.linear_halo_bias"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#PerturbedHalos.MassFunction.MassFunction.linear_halo_bias" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the linear halo bias, from the peak background split.</p>
<p>Associated bias functions are available for each mass function, and more can be user-defined. See the class description for details of the loaded parametrizations.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>m_h</strong> (<em>float</em>) – Mass in <span class="math notranslate nohighlight">\(h^{-1}M_\mathrm{sun}\)</span> units.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Linear Eulerian halo bias (dimensionless)</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">float</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="PerturbedHalos.MassFunction.MassFunction.mass_function">
<code class="descname">mass_function</code><span class="sig-paren">(</span><em>m_h</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PerturbedHalos/MassFunction.html#MassFunction.mass_function"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#PerturbedHalos.MassFunction.MassFunction.mass_function" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the mass function, equal to the number density of halos per unit logarithmic mass interval. This assumes the existence of a universal mass function, with</p>
<div class="math notranslate nohighlight">
\[dn/d\log_{10}M = f(\sigma(M))\frac{\bar{\rho}_M}{M} \frac{d\ln\sigma(M)}{d\log_{10}(M)}\]</div>
<p>where <span class="math notranslate nohighlight">\(f\)</span> is the universal mass function, <span class="math notranslate nohighlight">\(\bar{\rho}_M\)</span> is the mean matter density at redshift zero and <span class="math notranslate nohighlight">\(\sigma^2(M)\)</span> is the overdensity variance on spheres with a radius given by the Lagrangian radius for mass <span class="math notranslate nohighlight">\(M\)</span>.</p>
<p>For details of the available mass function parametrizations, see the class description.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">For efficiency, we return the mass function <span class="math notranslate nohighlight">\(\frac{dn}{d\log_{10}(M)}\)</span> rather than the standard form <span class="math notranslate nohighlight">\(\frac{dn}{dM}\)</span>.</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>m_h</strong> (<em>float</em>) – Mass in <span class="math notranslate nohighlight">\(h^{-1}M_\mathrm{sun}\)</span> units.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Mass function, <span class="math notranslate nohighlight">\(dn/d\log_{10}(M)\)</span> in <span class="math notranslate nohighlight">\(\mathrm{Mpc}^{-3}\)</span> units</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">float</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="PerturbedHalos.MassFunction.MassFunction.second_order_bias">
<code class="descname">second_order_bias</code><span class="sig-paren">(</span><em>m_h</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PerturbedHalos/MassFunction.html#MassFunction.second_order_bias"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#PerturbedHalos.MassFunction.MassFunction.second_order_bias" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the second order Eulerian bias, defined as <span class="math notranslate nohighlight">\(\frac{4}{21}b_1^L + \frac{1}{2}b_2^L\)</span> where <span class="math notranslate nohighlight">\(b_1^L\)</span> and <span class="math notranslate nohighlight">\(b_2^L\)</span> are the Lagrangian bias parameters.</p>
<p>Associated bias functions are available for each mass function, and more can be user-defined. See the class description for details of the loaded parametrizations.</p>
<p>Parameters:
- m_h: Mass in <span class="math notranslate nohighlight">\(h^{-1}M_\mathrm{sun}\)</span> units.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-PerturbedHalos.HaloPhysics">
<span id="halo-physics-module"></span><h2>Halo Physics Module<a class="headerlink" href="#module-PerturbedHalos.HaloPhysics" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="PerturbedHalos.HaloPhysics.HaloPhysics">
<em class="property">class </em><code class="descclassname">PerturbedHalos.HaloPhysics.</code><code class="descname">HaloPhysics</code><span class="sig-paren">(</span><em>cosmology</em>, <em>mass_function</em>, <em>concentration_name='Duffy'</em>, <em>profile_name='NFW'</em>, <em>**hyperparams</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PerturbedHalos/HaloPhysics.html#HaloPhysics"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#PerturbedHalos.HaloPhysics.HaloPhysics" title="Permalink to this definition">¶</a></dt>
<dd><p>Class to hold halo model quantities and relevant integrals.</p>
<p>Implemented Concentration Functions:</p>
<ul class="simple">
<li><strong>Duffy</strong>: Duffy et al. (2008) for virial-density haloes (second section in Table 1)</li>
</ul>
<p>Implemented Halo Profiles:</p>
<ul class="simple">
<li><strong>NFW</strong>: Navarro, Frenk &amp; White (1997) universal halo profile. We use the virial collapse overdensity from Bryan &amp; Norman 1998 to construct this.</li>
</ul>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>cosmology</strong> (<a class="reference internal" href="#PerturbedHalos.Cosmology.Cosmology" title="PerturbedHalos.Cosmology.Cosmology"><em>Cosmology</em></a>) – Instance of the Cosmology class containing relevant cosmology and functions.</li>
<li><strong>mass_function</strong> (<a class="reference internal" href="#PerturbedHalos.MassFunction.MassFunction" title="PerturbedHalos.MassFunction.MassFunction"><em>MassFunction</em></a>) – Instance of the MassFunction class, containing the mass function and bias</li>
<li><strong>concentration_name</strong> (<em>str</em>) – Concentration parametrization to use (see above), default: ‘Duffy’</li>
<li><strong>profile_name</strong> (<em>str</em>) – Halo profile parametrization to use (see above), default: ‘NFW’</li>
<li><strong>hyperparams</strong> (<em>kwargs</em>) – Any additional parameters to pass to the class (see below).</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">Keyword Arguments:</th></tr>
<tr class="field-even field"><td>&#160;</td><td class="field-body"><ul class="first last simple">
<li><strong>logM_min</strong> (<em>float</em>) – Minimum mass in <span class="math notranslate nohighlight">\(\log_{10}(M/M_\mathrm{sun})\)</span>, default: 6</li>
<li><strong>logM_max</strong> (<em>float</em>) – Maximum mass in <span class="math notranslate nohighlight">\(\log_{10}(M/M_\mathrm{sun})\)</span>, default: 17</li>
<li><strong>npoints</strong> (<em>int</em>) – Number of sampling points for <span class="math notranslate nohighlight">\(\sigma(M)\)</span> interpolation, default: 1e5</li>
<li><strong>tinker_overdensity</strong> (<em>int</em>) – (Only for the Tinker mass function): spherical overdensity defining halos, default: 200</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="PerturbedHalos.HaloPhysics.HaloPhysics.halo_concentration">
<code class="descname">halo_concentration</code><span class="sig-paren">(</span><em>m_h</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PerturbedHalos/HaloPhysics.html#HaloPhysics.halo_concentration"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#PerturbedHalos.HaloPhysics.HaloPhysics.halo_concentration" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the halo concentration <span class="math notranslate nohighlight">\(c = r_\mathrm{virial} / r_\mathrm{scale}\)</span>.</p>
<p>For details of the available concentration parametrizations, see the class description.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>m_h</strong> (<em>float</em>) – Mass in <span class="math notranslate nohighlight">\(h^{-1}M_{\odot}\)</span> units.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="PerturbedHalos.HaloPhysics.HaloPhysics.halo_profile">
<code class="descname">halo_profile</code><span class="sig-paren">(</span><em>m_h</em>, <em>k_phys</em>, <em>norm_only=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PerturbedHalos/HaloPhysics.html#HaloPhysics.halo_profile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#PerturbedHalos.HaloPhysics.HaloPhysics.halo_profile" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the halo profile function in Fourier space; <span class="math notranslate nohighlight">\(\rho(k|m) = \frac{m}{\bar{\rho}_M}u(k|m)\)</span>
where <span class="math notranslate nohighlight">\(\bar{\rho}_M\)</span> is the background matter density and <span class="math notranslate nohighlight">\(u(k|m)\)</span> is the halo profile.</p>
<p>We assume halos have a virial collapse overdensity here, based on the parametrization of Bryan &amp; Norman 1998.</p>
<p>For details of the available profile parametrizations, see the class description.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>m_h</strong> (<em>float</em>) – Mass in <span class="math notranslate nohighlight">\(h^{-1}M_\mathrm{sun}\)</span> units.</li>
<li><strong>k_phys</strong> (<em>float</em>) – Physical wavenumber in 1/Mpc units.</li>
<li><strong>norm_only</strong> (<em>bool</em>) – Boolean, if set, just return the normalization factor <span class="math notranslate nohighlight">\(m/\bar{\rho}_M\)</span>, default: False</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Halo profile <span class="math notranslate nohighlight">\(\rho(k|m)\)</span> or <span class="math notranslate nohighlight">\(m/\bar{\rho}_M\)</span>, if the norm_only parameter is set.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">float</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-PerturbedHalos.MassIntegrals">
<span id="mass-integrals-module"></span><h2>Mass Integrals Module<a class="headerlink" href="#module-PerturbedHalos.MassIntegrals" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="PerturbedHalos.MassIntegrals.MassIntegrals">
<em class="property">class </em><code class="descclassname">PerturbedHalos.MassIntegrals.</code><code class="descname">MassIntegrals</code><span class="sig-paren">(</span><em>cosmology</em>, <em>mass_function</em>, <em>halo_physics</em>, <em>kh_vector</em>, <em>min_logM=6.001</em>, <em>max_logM=16.999</em>, <em>N_mass=10000</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PerturbedHalos/MassIntegrals.html#MassIntegrals"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#PerturbedHalos.MassIntegrals.MassIntegrals" title="Permalink to this definition">¶</a></dt>
<dd><p>Class to compute and store the various mass integrals of the form</p>
<div class="math notranslate nohighlight">
\[I_p^{q1,q2}(k_1,...k_p) = \int n(m)b^{(q1)}(m)b^{(q2)}\frac{m^p}{\rho_M^p}u(k_1|m)..u(k_p|m)dm\]</div>
<p>which are needed to compute the power spectrum model. Here <span class="math notranslate nohighlight">\(b^{(q)}\)</span> is the q-th order bias (with <span class="math notranslate nohighlight">\(b^{0}=1\)</span>),
<span class="math notranslate nohighlight">\(u(k|m)\)</span> is the normalized halo profile and <span class="math notranslate nohighlight">\(n(m)\)</span> is the mass function.</p>
<p>All integrals are performed via Simpson’s rule over a specified mass range, and are simply returned if they are already computed.</p>
<p>For the <span class="math notranslate nohighlight">\(I_1^{1,0} = I_1^1\)</span> integral, the integral must be corrected to ensure that we recover the bias consistency relation <span class="math notranslate nohighlight">\(I_1^1 \rightarrow 1\)</span> as <span class="math notranslate nohighlight">\(k \rightarrow 0\)</span>.</p>
<p>This requires an infinite mass range, so we instead approximate;</p>
<div class="math notranslate nohighlight">
\[I_1^1(k)_{\mathrm{corrected}} = I_1^1(k) + ( 1 - I_1^1(0) ) u(k|m_min) / u(k|0)\]</div>
<p>for normalized halo profile <span class="math notranslate nohighlight">\(u\)</span>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>cosmology</strong> (<a class="reference internal" href="#PerturbedHalos.Cosmology.Cosmology" title="PerturbedHalos.Cosmology.Cosmology"><em>Cosmology</em></a>) – Instance of the Cosmology class containing relevant cosmology and functions.</li>
<li><strong>mass_function</strong> (<a class="reference internal" href="#PerturbedHalos.MassFunction.MassFunction" title="PerturbedHalos.MassFunction.MassFunction"><em>MassFunction</em></a>) – Instance of the MassFunction class, containing the mass function and bias.</li>
<li><strong>halo_physics</strong> (<a class="reference internal" href="#PerturbedHalos.HaloPhysics.HaloPhysics" title="PerturbedHalos.HaloPhysics.HaloPhysics"><em>HaloPhysics</em></a>) – Instance of the HaloPhysics class, containing the halo profiles and concentrations.</li>
<li><strong>kh_vector</strong> (<em>float</em>) – Array (or float) of wavenumbers in <span class="math notranslate nohighlight">\(h\mathrm{Mpc}^{-1}\)</span> units from which to compute mass integrals.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">Keyword Arguments:</th></tr>
<tr class="field-even field"><td>&#160;</td><td class="field-body"><ul class="first last simple">
<li><strong>min_logM</strong> (<em>float</em>) – Minimum mass in <span class="math notranslate nohighlight">\(\log_{10}(M/M_\mathrm{sun})\)</span> units, default: 6.001.</li>
<li><strong>max_logM</strong> (<em>float</em>) – Maximum mass in <span class="math notranslate nohighlight">\(\log_{10}(M/M_\mathrm{sun})\)</span> units, default: 16.999.</li>
<li><strong>N_mass</strong> (<em>int</em>) – Number of logarithmically spaced mass grid points, default: 10000.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="PerturbedHalos.MassIntegrals.MassIntegrals.compute_I_00">
<code class="descname">compute_I_00</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/PerturbedHalos/MassIntegrals.html#MassIntegrals.compute_I_00"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#PerturbedHalos.MassIntegrals.MassIntegrals.compute_I_00" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the I_0^0 integral, if not already computed.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Value of <span class="math notranslate nohighlight">\(I_0^0\)</span></td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">float</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="PerturbedHalos.MassIntegrals.MassIntegrals.compute_I_01">
<code class="descname">compute_I_01</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/PerturbedHalos/MassIntegrals.html#MassIntegrals.compute_I_01"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#PerturbedHalos.MassIntegrals.MassIntegrals.compute_I_01" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the I_0^1 integral, if not already computed.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Value of <span class="math notranslate nohighlight">\(I_0^1\)</span></td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">float</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="PerturbedHalos.MassIntegrals.MassIntegrals.compute_I_11">
<code class="descname">compute_I_11</code><span class="sig-paren">(</span><em>apply_correction=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PerturbedHalos/MassIntegrals.html#MassIntegrals.compute_I_11"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#PerturbedHalos.MassIntegrals.MassIntegrals.compute_I_11" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the <span class="math notranslate nohighlight">\(I_1^1(k)\)</span> integral, if not already computed. Also apply the correction noted in the class header if required.</p>
<p>When computing <span class="math notranslate nohighlight">\({}_i J_1^1\)</span> type integrals (over a finite mass bin), the correction should <em>not</em> be applied.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name" colspan="2">Keyword Arguments:</th></tr>
<tr class="field-odd field"><td>&#160;</td><td class="field-body"><strong>apply_correction</strong> (<em>bool</em>) – Whether to apply the correction in the class header to ensure the bias consistency relation is upheld.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Array of <span class="math notranslate nohighlight">\(I_1^1\)</span> values for each k.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">float</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="PerturbedHalos.MassIntegrals.MassIntegrals.compute_I_111">
<code class="descname">compute_I_111</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/PerturbedHalos/MassIntegrals.html#MassIntegrals.compute_I_111"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#PerturbedHalos.MassIntegrals.MassIntegrals.compute_I_111" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the <span class="math notranslate nohighlight">\(I_1^{1,1}\)</span> integral, if not already computed.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Array of <span class="math notranslate nohighlight">\(I_1^{1,1}\)</span> values for each k.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">float</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="PerturbedHalos.MassIntegrals.MassIntegrals.compute_I_12">
<code class="descname">compute_I_12</code><span class="sig-paren">(</span><em>apply_correction=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PerturbedHalos/MassIntegrals.html#MassIntegrals.compute_I_12"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#PerturbedHalos.MassIntegrals.MassIntegrals.compute_I_12" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the <span class="math notranslate nohighlight">\(I_1^2(k)\)</span> integral, if not already computed. Also apply the correction noted in the class header if required.</p>
<p>When computing <span class="math notranslate nohighlight">\({}_i J_1^2\)</span> type integrals (over a finite mass bin), the correction should <em>not</em> be applied.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name" colspan="2">Keyword Arguments:</th></tr>
<tr class="field-odd field"><td>&#160;</td><td class="field-body"><strong>apply_correction</strong> (<em>bool</em>) – Whether to apply the correction in the class header to ensure the bias consistency relation is upheld.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Array of <span class="math notranslate nohighlight">\(I_1^2\)</span> values for each k.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">float</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="PerturbedHalos.MassIntegrals.MassIntegrals.compute_I_20">
<code class="descname">compute_I_20</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/PerturbedHalos/MassIntegrals.html#MassIntegrals.compute_I_20"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#PerturbedHalos.MassIntegrals.MassIntegrals.compute_I_20" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the <span class="math notranslate nohighlight">\(I_2^0\)</span> integral, if not already computed. Note that we assume both k-vectors are the same here.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Array of <span class="math notranslate nohighlight">\(I_2^0\)</span> values for each k.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">float</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="PerturbedHalos.MassIntegrals.MassIntegrals.compute_I_21">
<code class="descname">compute_I_21</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/PerturbedHalos/MassIntegrals.html#MassIntegrals.compute_I_21"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#PerturbedHalos.MassIntegrals.MassIntegrals.compute_I_21" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the <span class="math notranslate nohighlight">\(I_2^1\)</span> integral, if not already computed. Note that we assume both k-vectors are the same here.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Array of <span class="math notranslate nohighlight">\(I_2^1\)</span> values for each k.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">float</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-PerturbedHalos.HaloPower">
<span id="halo-power-module"></span><h2>Halo Power Module<a class="headerlink" href="#module-PerturbedHalos.HaloPower" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="PerturbedHalos.HaloPower.HaloPower">
<em class="property">class </em><code class="descclassname">PerturbedHalos.HaloPower.</code><code class="descname">HaloPower</code><span class="sig-paren">(</span><em>cosmology</em>, <em>mass_function</em>, <em>halo_physics</em>, <em>mass_integrals</em>, <em>kh_vector</em>, <em>kh_min=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PerturbedHalos/HaloPower.html#HaloPower"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#PerturbedHalos.HaloPower.HaloPower" title="Permalink to this definition">¶</a></dt>
<dd><p>Class to compute the non-linear power spectrum from the halo model of Philcox et al. 2020.</p>
<p>The model power is defined as</p>
<div class="math notranslate nohighlight">
\[P_\mathrm{model} = I_1^1(k)^2 P_{NL}(k) W^2(kR) + I_2^0(k,k)\]</div>
<p>where <span class="math notranslate nohighlight">\(I_p^q\)</span> are mass function integrals defined in the MassIntegrals class, <span class="math notranslate nohighlight">\(P_{NL}\)</span> is the 1-loop non-linear power spectrum from Effective Field Theory and <span class="math notranslate nohighlight">\(W(kR)\)</span> is a smoothing window on scale R.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>cosmology</strong> (<a class="reference internal" href="#PerturbedHalos.Cosmology.Cosmology" title="PerturbedHalos.Cosmology.Cosmology"><em>Cosmology</em></a>) – Instance of the Cosmology class containing relevant cosmology and functions.</li>
<li><strong>mass_function</strong> (<a class="reference internal" href="#PerturbedHalos.MassFunction.MassFunction" title="PerturbedHalos.MassFunction.MassFunction"><em>MassFunction</em></a>) – Instance of the MassFunction class, containing the mass function and bias.</li>
<li><strong>halo_physics</strong> (<a class="reference internal" href="#PerturbedHalos.HaloPhysics.HaloPhysics" title="PerturbedHalos.HaloPhysics.HaloPhysics"><em>HaloPhysics</em></a>) – Instance of the HaloPhysics class, containing the halo profiles and concentrations.</li>
<li><strong>mass_integrals</strong> (<em>mass_integrals</em>) – Instance of the MassIntegrals class, containing the mass integrals.</li>
<li><strong>kh_vector</strong> (<em>float</em>) – Vector of wavenumbers (in <span class="math notranslate nohighlight">\(h/\mathrm{Mpc}\)</span> units), for which power spectrum will be computed.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">Keyword Arguments:</th></tr>
<tr class="field-even field"><td>&#160;</td><td class="field-body"><p class="first last"><strong>kh_min</strong> – Minimum k vector in the simulation (or survey) region in <span class="math notranslate nohighlight">\(h/\mathrm{Mpc}\)</span> units. Modes below kh_min are set to zero, default: 0.</p>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="PerturbedHalos.HaloPower.HaloPower.compute_one_loop_only_power">
<code class="descname">compute_one_loop_only_power</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/PerturbedHalos/HaloPower.html#HaloPower.compute_one_loop_only_power"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#PerturbedHalos.HaloPower.HaloPower.compute_one_loop_only_power" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the one-loop SPT power from the linear power spectrum in the Cosmology class. This returns the one-loop power evaluated at the wavenumber vector specfied in the class initialization. When first called, this computes an interpolator function, which is used in this and subsequent calls.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Vector of 1-loop power <span class="math notranslate nohighlight">\(P_\mathrm{1-loop}(k)\)</span> for the input k-vector.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">float</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="PerturbedHalos.HaloPower.HaloPower.compute_resummed_linear_power">
<code class="descname">compute_resummed_linear_power</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/PerturbedHalos/HaloPower.html#HaloPower.compute_resummed_linear_power"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#PerturbedHalos.HaloPower.HaloPower.compute_resummed_linear_power" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the IR-resummed linear power spectrum, using the linear power spectrum in the Cosmology class.</p>
<p>The output power is defined by</p>
<div class="math notranslate nohighlight">
\[P_\mathrm{lin, IR} = P_\mathrm{lin, nw}(k) + P_\mathrm{lin, w}e^{-k^2\Sigma^2}\]</div>
<p>where ‘nw’ and ‘w’ refer to the no-wiggle and wiggle parts of the linear power spectrum and <span class="math notranslate nohighlight">\(\Sigma^2\)</span> is the BAO damping scale (computed in the _prepare_IR_resummation function)</p>
<p>If already computed, the IR resummed linear power is simply returned.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Vector of IR-resummed linear power <span class="math notranslate nohighlight">\(P_\mathrm{lin,IR}(k)\)</span> for the input k-vector.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">float</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="PerturbedHalos.HaloPower.HaloPower.compute_resummed_one_loop_power">
<code class="descname">compute_resummed_one_loop_power</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/PerturbedHalos/HaloPower.html#HaloPower.compute_resummed_one_loop_power"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#PerturbedHalos.HaloPower.HaloPower.compute_resummed_one_loop_power" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the IR-resummed linear-plus-one-loop power spectrum, using the linear power spectrum in the Cosmology class.</p>
<p>The output power is defined by</p>
<div class="math notranslate nohighlight">
\[P_\mathrm{lin-plus-1-loop, IR} = P_\mathrm{lin, nw}(k) + P_\mathrm{1-loop, nw}(k) + e^{-k^2\Sigma^2} [ P_\mathrm{lin, w}(k) (1 + k^2\Sigma^2) + P_\mathrm{1-loop,w}(k) ]\]</div>
<p>where ‘nw’ and ‘w’ refer to the no-wiggle and wiggle parts of the linear / 1-loop power spectrum and <span class="math notranslate nohighlight">\(Sigma^2\)</span> is the BAO damping scale (computed in the _prepare_IR_resummation function)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Vector of IR-resummed linear-plus-one-loop power <span class="math notranslate nohighlight">\(P_\mathrm{lin-plus-1-loop,IR}(k)\)</span> for the input k-vector.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">float</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="PerturbedHalos.HaloPower.HaloPower.halo_power">
<code class="descname">halo_power</code><span class="sig-paren">(</span><em>cs2</em>, <em>R</em>, <em>pt_type='EFT'</em>, <em>pade_resum=True</em>, <em>smooth_density=True</em>, <em>IR_resum=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PerturbedHalos/HaloPower.html#HaloPower.halo_power"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#PerturbedHalos.HaloPower.HaloPower.halo_power" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the non-linear halo-model power spectrum to one-loop order, with IR corrections and counterterms. Whilst we recommend including all non-linear effects, these can be optionally removed with the Boolean parameters.</p>
<p>This is similar to the ‘non_linear_power()’ function, but includes the halo mass integrals, and is the <em>complete</em> model of the matter power spectrum at one-loop-order in our approximations. Note that the function requires two free parameters; the smoothing scale R and the effective squared sound-speed <span class="math notranslate nohighlight">\(c_s^2\)</span>, which cannot be predicted from theory. (Note that <span class="math notranslate nohighlight">\(c_s^2&lt;0\)</span> is permissible).</p>
<p>For further details, see the class description.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>cs2</strong> (<em>float</em>) – Squared-speed-of-sound counterterm <span class="math notranslate nohighlight">\(c_s^2\)</span> in <span class="math notranslate nohighlight">\((h^{-1}\mathrm{Mpc})^2\)</span> units. (Unused if pt_type is not “EFT”)</li>
<li><strong>R</strong> (<em>float</em>) – Smoothing scale in <span class="math notranslate nohighlight">\(h^{-1}Mpc\)</span>. This is a free parameter of the model. (Unused if smooth_density = False)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">Keyword Arguments:</th></tr>
<tr class="field-even field"><td>&#160;</td><td class="field-body"><ul class="first simple">
<li><strong>pt_type</strong> (<em>str</em>) – Which flavor of perturbation theory to adopt. Options ‘EFT’ (linear + 1-loop + counterterm), ‘SPT’ (linear + 1-loop), ‘Linear’, default: ‘EFT’</li>
<li><strong>pade_resum</strong> (<em>bool</em>) – If True, use a Pade resummation of the counterterm <span class="math notranslate nohighlight">\(k^2/(1+k^2) P_\mathrm{lin}\)</span> rather than <span class="math notranslate nohighlight">\(k^2 P_\mathrm{lin}(k)\)</span>, default: True</li>
<li><strong>smooth_density</strong> (<em>bool</em>) – If True, smooth the density field on scale R, i.e. multiply power by W(kR)^2, default: True</li>
<li><strong>IR_resum</strong> (<em>bool</em>) – If True, perform IR resummation on the density field to resum non-perturbative long-wavelength modes, default: True</li>
</ul>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Non-linear halo model power spectrum <span class="math notranslate nohighlight">\(P_\mathrm{halo}\)</span> evaluated at the input k-vector.</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">float</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="PerturbedHalos.HaloPower.HaloPower.non_linear_power">
<code class="descname">non_linear_power</code><span class="sig-paren">(</span><em>cs2</em>, <em>R</em>, <em>pt_type='EFT'</em>, <em>pade_resum=True</em>, <em>smooth_density=True</em>, <em>IR_resum=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PerturbedHalos/HaloPower.html#HaloPower.non_linear_power"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#PerturbedHalos.HaloPower.HaloPower.non_linear_power" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the non-linear power spectrum to one-loop order, with IR corrections and counterterms. Whilst we recommend including all non-linear effects, these can be optionally removed with the Boolean parameters. Setting (pt_type=’Linear’, pade_resum=False, smooth_density=False, IR_resum = False) recovers the standard halo model prediction.</p>
<p>Including all relevant effects, this is defined as</p>
<div class="math notranslate nohighlight">
\[P_\mathrm{NL}(k, R, c_s^2) = [P_\mathrm{lin}(k) + P_\mathrm{1-loop}(k) + P_\mathrm{counterterm}(k;c_s^2)] W(kR)\]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[P_\mathrm{counterterm}(k;c_s^2) = - c_s^2 * \frac{k^2 }{(1 + k^2)} P_\mathrm{lin}(k)\]</div>
<p>is the counterterm, and IR resummation is applied to all spectra.</p>
<p>This computes the relevant integrals if they haven’t already been computed. The function returns <span class="math notranslate nohighlight">\(P_\mathrm{NL}\)</span> given smoothing scale R and effective squared sound-speed <span class="math notranslate nohighlight">\(c_s^2\)</span>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>cs2</strong> (<em>float</em>) – Squared-speed-of-sound counterterm <span class="math notranslate nohighlight">\(c_s^2\)</span> in <span class="math notranslate nohighlight">\((h^{-1}\mathrm{Mpc})^2\)</span> units. (Unused if pt_type is not “EFT”)</li>
<li><strong>R</strong> (<em>float</em>) – Smoothing scale in <span class="math notranslate nohighlight">\(h^{-1}Mpc\)</span>. This is a free parameter of the model. (Unused if smooth_density = False)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">Keyword Arguments:</th></tr>
<tr class="field-even field"><td>&#160;</td><td class="field-body"><ul class="first simple">
<li><strong>pt_type</strong> (<em>str</em>) – Which flavor of perturbation theory to adopt. Options ‘EFT’ (linear + 1-loop + counterterm), ‘SPT’ (linear + 1-loop), ‘Linear’, default: ‘EFT’</li>
<li><strong>pade_resum</strong> (<em>bool</em>) – If True, use a Pade resummation of the counterterm <span class="math notranslate nohighlight">\(k^2/(1+k^2) P_\mathrm{lin}\)</span> rather than <span class="math notranslate nohighlight">\(k^2 P_\mathrm{lin}(k)\)</span>, default: True</li>
<li><strong>smooth_density</strong> (<em>bool</em>) – If True, smooth the density field on scale R, i.e. multiply power by W(kR)^2, default: True</li>
<li><strong>IR_resum</strong> (<em>bool</em>) – If True, perform IR resummation on the density field to resum non-perturbative long-wavelength modes, default: True</li>
</ul>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Non-linear power spectrum <span class="math notranslate nohighlight">\(P_\mathrm{NL}\)</span> evaluated at the input k-vector.</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">float</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-PerturbedHalos.CountsCovariance">
<span id="counts-covariance-module"></span><h2>Counts Covariance Module<a class="headerlink" href="#module-PerturbedHalos.CountsCovariance" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="PerturbedHalos.CountsCovariance.CountsCovariance">
<em class="property">class </em><code class="descclassname">PerturbedHalos.CountsCovariance.</code><code class="descname">CountsCovariance</code><span class="sig-paren">(</span><em>cosmology</em>, <em>mass_function</em>, <em>halo_physics</em>, <em>mass_integrals</em>, <em>kh_vector</em>, <em>mass_bins</em>, <em>volume</em>, <em>kh_min=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PerturbedHalos/CountsCovariance.html#CountsCovariance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#PerturbedHalos.CountsCovariance.CountsCovariance" title="Permalink to this definition">¶</a></dt>
<dd><p>Class to compute the covariance of cluster counts and the non-linear power spectrum using the halo model of Philcox et al. 2020</p>
<p>The model covariance is defined as</p>
<div class="math notranslate nohighlight">
\[\mathrm{cov}_\mathrm{no SSC}(N_i, P(k)) = I_1^1(k) [ 2 iJ_1^1(k) P_{NL}(k) W^2(kR) + ... ] + iJ_2^0(k,k)\]</div>
<p>where <span class="math notranslate nohighlight">\(I_p^q\)</span> and <span class="math notranslate nohighlight">\(iJ_p^q\)</span> are mass function integrals defined in the MassIntegrals class for mass bin i, <span class="math notranslate nohighlight">\(P_{NL}\)</span> is the 1-loop non-linear power spectrum from Effective Field Theory and <span class="math notranslate nohighlight">\(W(kR)\)</span> is a smoothing window on scale R. The ellipses refer to 1-loop bispectrum and trispectrum terms which are usually ignored.</p>
<p><span class="math notranslate nohighlight">\(N_i\)</span> is defined as the number of halos in a mass bin defined by [<span class="math notranslate nohighlight">\(m_{low,i}\)</span>, <span class="math notranslate nohighlight">\(m_{high,i}\)</span>]</p>
<p>There is an additional contribution from super-sample-covariance:</p>
<div class="math notranslate nohighlight">
\[\mathrm{cov}_\mathrm{SSC}(N_i, P(k)) = V \sigma^2(V) iJ_0^1 [ I_1^1(k) I_1^{1,1}(k) W^2(kR)  + I_2^1(k) ]\]</div>
<p>where <span class="math notranslate nohighlight">\(\sigma^2(V)\)</span> is the variance of the linear density field on scales with volume V.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>cosmology</strong> (<a class="reference internal" href="#PerturbedHalos.Cosmology.Cosmology" title="PerturbedHalos.Cosmology.Cosmology"><em>Cosmology</em></a>) – Class containing relevant cosmology and functions.</li>
<li><strong>mass_function</strong> (<a class="reference internal" href="#PerturbedHalos.MassFunction.MassFunction" title="PerturbedHalos.MassFunction.MassFunction"><em>MassFunction</em></a>) – Class containing the mass function and bias.</li>
<li><strong>halo_physics</strong> (<a class="reference internal" href="#PerturbedHalos.HaloPhysics.HaloPhysics" title="PerturbedHalos.HaloPhysics.HaloPhysics"><em>HaloPhysics</em></a>) – Class containing the halo profiles and concentrations.</li>
<li><strong>mass_integrals</strong> (<a class="reference internal" href="#PerturbedHalos.MassIntegrals.MassIntegrals" title="PerturbedHalos.MassIntegrals.MassIntegrals"><em>MassIntegrals</em></a>) – Class containing the mass integrals.</li>
<li><strong>kh_vector</strong> (<em>float</em>) – Vector of wavenumbers (in <span class="math notranslate nohighlight">\(h/\mathrm{Mpc}\)</span> units), for which power spectrum will be computed.</li>
<li><strong>mass_bins</strong> (<em>float</em>) – Array of mass bin edges, in <span class="math notranslate nohighlight">\(h^{-1}M_\mathrm{sun}\)</span> units. Must have length N_bins + 1.</li>
<li><strong>volume</strong> – Volume of the survey in :math:<a href="#id1"><span class="problematic" id="id2">`</span></a>(h^{-1}mathrm{Mpc})^3. The variance of the linear field will be computed for radius giving this volume</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">Keyword Arguments:</th></tr>
<tr class="field-even field"><td>&#160;</td><td class="field-body"><p class="first last"><strong>kh_min</strong> – Minimum k vector in the simulation (or survey) region in <span class="math notranslate nohighlight">\(h/\mathrm{Mpc}\)</span> units. Modes below kh_min are set to zero, default 0.</p>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="PerturbedHalos.CountsCovariance.CountsCovariance.counts_covariance">
<code class="descname">counts_covariance</code><span class="sig-paren">(</span><em>cs2</em>, <em>R</em>, <em>use_SSC=True</em>, <em>pt_type='EFT'</em>, <em>pade_resum=True</em>, <em>smooth_density=True</em>, <em>IR_resum=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PerturbedHalos/CountsCovariance.html#CountsCovariance.counts_covariance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#PerturbedHalos.CountsCovariance.CountsCovariance.counts_covariance" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the full SSC+no-SSC covariance matrix of <span class="math notranslate nohighlight">\(N_i, P(k)\)</span> as defined in the class description. Whilst we recommend including all non-linear effects, these can be optionally removed with the Boolean parameters. Setting (pt_type=’Linear’, pade_resum=False, smooth_density=False, IR_resum = False) recovers the standard halo model prediction.</p>
<p>If use_SSC = False, then we only return the non-SSC covariance.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>cs2</strong> (<em>float</em>) – Squared-speed-of-sound <span class="math notranslate nohighlight">\(c_s^2\)</span> counterterm in <span class="math notranslate nohighlight">\((h^{-1}\mathrm{Mpc})^2\)</span> units. (Unused if pt_type is not “EFT”)</li>
<li><strong>R</strong> (<em>float</em>) – Smoothing scale in :math:h^{-1}`mathrm{Mpc}`. This is a free parameter of the model. (Unused if smooth_density = False)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">Keyword Arguments:</th></tr>
<tr class="field-even field"><td>&#160;</td><td class="field-body"><ul class="first simple">
<li><strong>use_SSC</strong> (<em>bool</em>) – Whether to include the super-sample covariance (SSC) terms, default: True</li>
<li><strong>pt_type</strong> (<em>str</em>) – Which flavor of perturbation theory to adopt. Options ‘EFT’ (linear + 1-loop + counterterm), ‘SPT’ (linear + 1-loop), ‘Linear’, default: ‘EFT’</li>
<li><strong>pade_resum</strong> (<em>bool</em>) – If True, use a Pade resummation of the counterterm <span class="math notranslate nohighlight">\(k^2/(1+k^2) P_\mathrm{lin}\)</span> rather than <span class="math notranslate nohighlight">\(k^2 P_\mathrm{lin}(k)\)</span>, default: True</li>
<li><strong>smooth_density</strong> (<em>bool</em>) – If True, smooth the density field on scale R, i.e. multiply power by W(kR)^2, default: True</li>
<li><strong>IR_resum</strong> (<em>bool</em>) – If True, perform IR resummation on the density field to resum non-perturbative long-wavelength modes, default: True</li>
</ul>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Two-dimensional array of <span class="math notranslate nohighlight">\(\mathrm{cov}(N_i,P(k))\)</span> with shape (N_bins, N_k) for N_bins mass bins and N_k power spectrum bins.</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">float</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="index.html" class="btn btn-neutral float-left" title="Welcome to PerturbedHalos’s documentation!" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Oliver H. E. Philcox

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>